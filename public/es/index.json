[{"authors":["admin"],"categories":null,"content":"Sitio web del aspirante al científico de datos James Attwood, que centra su investigación en el uso del aprendizaje automático en cuestiones geográficas y de ciudades inteligentes.\n","date":-62135596800,"expirydate":-62135596800,"kind":"taxonomy","lang":"es","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/es/author/james-attwood/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/es/author/james-attwood/","section":"authors","summary":"Sitio web del aspirante al científico de datos James Attwood, que centra su investigación en el uso del aprendizaje automático en cuestiones geográficas y de ciudades inteligentes.","tags":null,"title":"James Attwood","type":"authors"},{"authors":null,"categories":null,"content":" Donde viven los inmigrantes en Santiago de Chile? Hace un par de meses lleve acabo una investigación de donde viven los inmigrantes en Santiago de Chile, el informe se puede leer acá https://portugalconcopiapo.wordpress.com/2020/03/27/mapeo-de-datos-de-inmigracion-en-santiago-de-chile/. Se expone unos puntos interesantes sobre la cantidad de inmigrantes y también su ubicación cuando llegaban. Mientras estaba haciendo esa investigación me dí cuenta que había unos puntos débiles que se podría mejorar, uno de los cuales es repetir la investigación pero con datos mas actualizados. Por lo tanto, este informe investigará donde vivieran inmigrantes que llegaron en 2019. Esta vez en adición se usarán métodos de clasificación de aprendizaje automático para intentar predecir si los inmigrantes vivieran en el Sector Orriente de Santiago o no. Mas información se puede leer del Sector Oriente en Sector Orriente.\n1) Información de Fondo Paquestes library(dplyr) library(lubridate) library(chilemapas) library(ggplot2) library(sf) library(ggspatial) library(caret) library(modelr) library(forcats) library(caTools)  Base de datos El base de datos se puede descargar en https://www.extranjeria.gob.cl/media/2020/03/visas_otorgadas_2019.xlsx. Tiene 328.118 observaciones con 14 variables. Los variables son:\n Sexo: corresponde al sexo de la persona.\n Fecha de Nacimiento: corresponde a la fecha de nacimiento. Actividad: corresponde a la actividad a la cual se dedica la persona. Profesión: corresponde a la profesión. País: corresponde a la nacionalidad de la persona. Estudios: corresponde al nivel de instrucción formal. Comuna: corresponde a la comuna de residencia que declara al momento de realizar su solicitud y no da cuenta necesariamente de la residencia actual de la persona. Provincia: corresponde a la provincia asociada a la comuna de residencia que declara. Región: corresponde a la región de residencia asociada a la provincia. TIT-DEP: se refiere a la categoría TITULAR que corresponde al extranjero a quien se le otorga el permiso de residencia, y a la categoría de DEPENDIENTE que corresponde a la familia directa del extranjero que posee la residencia. AUT: corresponde a la Autoridad migratoria que recibe la solicitud de residencia. Beneficio_Agrupado: corresponde a las categorías de visa expuestas anteriormente y en el caso de las permanencias definitivas, corresponde al registro de dicho permiso migratorio. Año: se refiere al año eu que se otorga el permiso migratorio. Mes: se refiere al mes en que se otorga el permiso migratorio.    2) Limpieza de Los Datos Cargar el base de datos Primero cargué el base de datos, y lo filtré para solo tener resultados para Metropolitana de Santiago. Es importante tener en cuenta acá que las comunas de San Bernado y Puente Alto no se inlcuyen en este analisis ya que forman partes de otros provincias, y no la de Santiago.\nsetwd(\u0026quot;~/Documents/Machine Learning/4. Proyectos/Migration/Data Sets\u0026quot;) visas2019 \u0026lt;- read.csv(\u0026quot;visas_otorgadas_2019.csv\u0026quot;) visas2019STG \u0026lt;- visas2019 %\u0026gt;% filter(REGIÓN == \u0026quot;Metropolitana de Santiago\u0026quot;) visas2019STG \u0026lt;- visas2019STG %\u0026gt;% filter(PROVINCIA == \u0026#39;Santiago\u0026#39;) Limpieza de los datos Empecé con una limpieza para preparar los datos. Específicamente hago los siguientes tramites:\n Revisé si había valores faltantes Usé el variable de Nacimiento para calcular la edad de cada inmigrante. Agregué coordenadas geográficas al base de datos.   Valores faltantes Analicé cada variable individualmente en una tabla para ver si habían observaciones con valores faltantes. Se muestró que varios variables tenia una categoría de ‘No Informa’ ya incluida. Sin embargo un variable TIT-DEP tiene 15.902 observaciones sin un valor. En linea con los otros variables que incluyen la categoría de ‘No informa’, ingresé ‘No informa’ para esas 15.902 observaciones.\ntable(visas2019STG$ACTIVIDAD) # Tiene categoria de \u0026#39;No Informa\u0026#39; table(visas2019STG$PROFESIÓN) #Tiene categoria de \u0026#39;No Informa\u0026#39; table(visas2019STG$ESTUDIOS) # Tiene categoria de \u0026#39;No Informa\u0026#39; table(visas2019STG$TIT_DEP) levels(visas2019STG$TIT_DEP) levels(visas2019STG$TIT_DEP)[1] \u0026lt;- \u0026quot;No Informa\u0026quot; table(visas2019STG$TIT_DEP) Después de eso borré los observaciones que tenían valores de “No Informa” para cualquiera de las variables.\nvisas2019STG \u0026lt;- visas2019STG %\u0026gt;% filter(!ACTIVIDAD == \u0026quot;No Informa\u0026quot; ) %\u0026gt;% filter(!PROFESIÓN == \u0026quot;No Informa\u0026quot;) %\u0026gt;% filter(!ESTUDIOS == \u0026quot;No Informa\u0026quot;) %\u0026gt;% filter(!TIT_DEP == \u0026quot;No Informa\u0026quot;)  Fecha de nacimiento Quise convertir la fecha de nacimiento a edad. Para hacer esto usé el paquete lubridate.\nvisas2019STG$NACIMIENTO \u0026lt;- as.Date(visas2019STG$NACIMIENTO) year \u0026lt;- 2020 Birth_year \u0026lt;- year(visas2019STG$NACIMIENTO) visas2019STG \u0026lt;- visas2019STG %\u0026gt;% mutate(Age = year - Birth_year)  Las Coordinados Le agregé coordenadas geográficas al base de datos para que después podriía trazar mi analysis. Se usaba el paquete de Chile Mapas que tiene las coordenadas para cada comuna en Chile.\nChile \u0026lt;- chilemapas::codigos_territoriales STG \u0026lt;- Chile %\u0026gt;% filter(nombre_provincia == \u0026#39;Santiago\u0026#39;) Comunas \u0026lt;- chilemapas::mapa_comunas STGgeo \u0026lt;- left_join(STG, Comunas) ## Joining, by = c(\u0026quot;codigo_comuna\u0026quot;, \u0026quot;codigo_provincia\u0026quot;, \u0026quot;codigo_region\u0026quot;) STGgeo tiene los nombres de cada comuna en Santiago y sus coordinados. Cobiné estos coordinados con el base de datos visas2019STG. Pero primero tuve que cambiar el nombre de COMUNA a comuna_name para que se reflejara el nombre de ese variable en STGgeo. Tambien tuve que cambiar como se escriben los nombres de algunos comunas que llevaban tildes, para que se escribieran igual en STGgeo y visas2019STG.\nCambiar el nombre de COMUNA visas2019STG \u0026lt;- visas2019STG %\u0026gt;% rename(nombre_comuna = COMUNA)  Cambiar nombre_comuna a un factor visas2019STG$nombre_comuna \u0026lt;- as.factor(visas2019STG$nombre_comuna)  Cambiar los nombres de comunas que llevan tildes STGgeo[4, 2] = \u0026quot;Conchalí\u0026quot; STGgeo[6, 2] = \u0026quot;Estación Central\u0026quot; STGgeo[19, 2] = \u0026quot;Maipú\u0026quot; STGgeo[20, 2] = \u0026quot;Ñuñoa\u0026quot; STGgeo[22, 2] = \u0026quot;Peñalolén\u0026quot; STGgeo[29, 2] = \u0026quot;San Joaquín\u0026quot; STGgeo[31, 2] = \u0026quot;San Ramón\u0026quot; Combiné STGgeo con visas2019STG, y le di al nuevo base de datos el mismo nombre visas2019STG.\nvisas2019STG \u0026lt;- left_join(visas2019STG, STGgeo)     3) Analysis Inicial Nacionalidades Los datos originales muestran que en 2019 en la provincia de Santiago 156.260 inmigrantes llegaron. Estos inmigrantes se dividían en 76 nacionalidades\nSin embargo, cuando filtré los datos, usando los pasos anteriores, esta cifra se reducía a 98.655 divididos en 76 nacionalidades. Venezolanos represetan 58.80% con 58.009 llegadas.\nEn los 10 principales países para llegadas, 8 son de Sudamérica o Centroamérica, con China y Los Estados Unidos las únicas excepciónes. También se nota que 6 de esos 10 países hablan Español, con Brasil, Haiti, Los Estados Unidos y China los que hablan otros idiomas.\nvisas2019STG %\u0026gt;% group_by(PAÍS) %\u0026gt;% count() %\u0026gt;% arrange(-n) ## # A tibble: 75 x 2 ## # Groups: PAÍS [75] ## PAÍS n ## \u0026lt;fct\u0026gt; \u0026lt;int\u0026gt; ## 1 Venezuela 58009 ## 2 Perú 11474 ## 3 Colombia 8465 ## 4 Haití 7135 ## 5 Bolivia 2424 ## 6 Ecuador 2119 ## 7 Argentina 1988 ## 8 Brasil 1335 ## 9 China 923 ## 10 Estados Unidos 564 ## # … with 65 more rows  Donde viven Se expone que la comuna mas popular es Santiago con 30.207 inmigrantes en 2019. Esto no es soprendiente ya que Santiago es el centro de la ciudad, donde hay más accesso a servicios, oportunidades de trabajo, y alojamiento. Sin embargo hay que tener en cuenta que este base de datos solo muestra la comuna de residencia al momento de realizar su solicitud para su visa. Es posible que un inmigrante se mueva a un sector diferente de la ciudad cuando se haya acostumbrado y ya tenga un red de apoyo.\ncomuna_count \u0026lt;- visas2019STG %\u0026gt;% group_by(nombre_comuna) %\u0026gt;% count() %\u0026gt;% arrange(-n) comuna_count ## # A tibble: 32 x 2 ## # Groups: nombre_comuna [32] ## nombre_comuna n ## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; ## 1 Santiago 30207 ## 2 Estación Central 8080 ## 3 Independencia 7291 ## 4 Quinta Normal 4343 ## 5 San Miguel 4124 ## 6 Recoleta 3871 ## 7 Ñuñoa 3736 ## 8 Las Condes 3591 ## 9 La Florida 3571 ## 10 Maipú 2780 ## # … with 22 more rows Le agregé estos cifras al STGgeo para poder crear un mapa con el paquete ggplot que se matizaba según la cantidad de inmigrantes en cada comuna. Tambien calculé el punto al medio de cada comuna y le agregé al STGgeo.\nSTGgeo \u0026lt;- left_join(STGgeo, comuna_count, by = \u0026quot;nombre_comuna\u0026quot;) STGgeo \u0026lt;- STGgeo %\u0026gt;% rename(number_inmigrantes = n) STGgeo \u0026lt;- cbind(STGgeo, st_coordinates(st_centroid(STGgeo$geometry))) ## Warning in st_centroid.sfc(STGgeo$geometry): st_centroid does not give correct ## centroids for longitude/latitude data labels \u0026lt;- seq(1,32)   4) Mapas de Ubicación En esta secćion se presentan cuatro mapas.\nMapa 4.1 muestra la distribućion a lo largo de Santiago de todos los inmigrantes qye llegaron en 2019.\nMapa 4.2 muestra la distribućion de inmigrantes venezolanos.\nMapa 4.3 muestra la distribućion de inmigrantes haitianos.\nMapa 4.4 muestra la distribućion de inmigrantes de Los Estados Unidos.\nMapa 4.5 muestra la distribućion de inmigrantes peruanos.\nEstos cuatros nacionalidades se les eligieron ya que toman un papel importante en patrones de inmigración en Santiago. Ha sido un gran aumento en la cantidad de Venezolanos en los ultimos años por la situacion en su propio país. Tambien en los ultimos años Santiago ha experimentado un gran aumento en inmigrantes haitianos. Los peruanos son la nacionalidad que historicamente ha sido la mayor contribuente de inmigrantes en Chile. Los Estados Unidos es el país con el mas grande producto interno bruto per cápita entre las 10 principales nacionalidades de inmigrantes que llegaron a Santiago en 2019, así que es interesante ver su distribución por Santiago. Las cifras de PIB per cápita (World Bank, 2018) se muestra en $US a continuación.\nLos Estados Unidos = 62.887 Perú = $6.941 Colombia = $6.668 Haití = $868.3 Bolivia = $3.549 Ecuador = $6.345 Argentina = $11.684 Brasil = $9.001 China = $9.771\nPor comparision el PIB per cápita de Chile es $15.923.\nDistribución de todos los inmigrantes ggplot() + geom_sf(data = STGgeo$geometry, aes(fill = STGgeo$number_inmigrantes)) + scale_fill_viridis_c(option = \u0026quot;inferno\u0026quot;,trans = \u0026#39;sqrt\u0026#39;) + geom_text(data = STGgeo, aes(X, Y, label = labels), size = 3, color = \u0026quot;white\u0026quot;) + annotation_north_arrow(aes(which_north = \u0026quot;true\u0026quot;, location = \u0026quot;br\u0026quot;), pad_y = unit(0.8, \u0026quot;cm\u0026quot;)) + annotation_scale(aes(location = \u0026quot;br\u0026quot;, style = \u0026quot;bar\u0026quot;)) + theme(panel.grid.major = element_line(color = gray(0.5), linetype = \u0026quot;dashed\u0026quot;)) + theme (panel.background = element_rect(fill = \u0026quot;light grey\u0026quot;)) + ggtitle(\u0026quot;4.1 Ubicacion de Inmigrantes que llegaron en 2019\u0026quot;) + xlab(\u0026quot;Longitude\u0026quot;) + ylab(\u0026quot;Latitude\u0026quot;) + labs(fill = \u0026quot;Numero\u0026quot;)  Distribución de los venezolanos En este mapa se expone que los venezolanos se concentran con 21.387 en la comuna de Santiago. Esta cifra corresponde a 36.88% de los venezolanos que llegaron en 2019. Estacion Central y Independencia son las comunas con el segundo y el tercer mayor número de llegadas venezolanos. En relación al sector orriente, hubieron 1.998 llegadas venezolanos.\nvenezuela_count \u0026lt;- visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Venezuela\u0026#39;) %\u0026gt;% group_by(nombre_comuna) %\u0026gt;% count() %\u0026gt;% arrange(-n) venezuela_count ## # A tibble: 32 x 2 ## # Groups: nombre_comuna [32] ## nombre_comuna n ## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; ## 1 Santiago 21387 ## 2 Estación Central 5628 ## 3 Independencia 4710 ## 4 San Miguel 3318 ## 5 Quinta Normal 2805 ## 6 Ñuñoa 2622 ## 7 La Florida 2339 ## 8 Macul 1575 ## 9 Maipú 1537 ## 10 La Cisterna 1237 ## # … with 22 more rows visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Venezuela\u0026#39; \u0026amp; nombre_comuna %in% c(\u0026#39;Providencia\u0026#39;, \u0026quot;Las Condes\u0026quot;, \u0026#39;Vitacura\u0026#39;, \u0026#39;Lo Barnechea\u0026#39;)) %\u0026gt;% count() ## # A tibble: 1 x 1 ## n ## \u0026lt;int\u0026gt; ## 1 1998 STGgeo \u0026lt;- left_join(STGgeo, venezuela_count, by = \u0026quot;nombre_comuna\u0026quot;) STGgeo \u0026lt;- STGgeo %\u0026gt;% rename(numero_venezuelanos = n) ggplot() + geom_sf(data = STGgeo$geometry, aes(fill = STGgeo$numero_venezuelanos)) + scale_fill_viridis_c(option = \u0026quot;inferno\u0026quot;,trans = \u0026#39;sqrt\u0026#39;) + geom_text(data = STGgeo, aes(X, Y, label = labels), size = 3, color = \u0026quot;white\u0026quot;) + annotation_north_arrow(aes(which_north = \u0026quot;true\u0026quot;, location = \u0026quot;br\u0026quot;), pad_y = unit(0.8, \u0026quot;cm\u0026quot;)) + annotation_scale(aes(location = \u0026quot;br\u0026quot;, style = \u0026quot;bar\u0026quot;)) + theme(panel.grid.major = element_line(color = gray(0.5), linetype = \u0026quot;dashed\u0026quot;)) + theme (panel.background = element_rect(fill = \u0026quot;light grey\u0026quot;)) + ggtitle(\u0026quot;4.2 Ubicacion de Inmigrantes Venezolanos que llegaron en 2019\u0026quot;) + xlab(\u0026quot;Longitude\u0026quot;) + ylab(\u0026quot;Latitude\u0026quot;) + labs(fill = \u0026quot;Numero\u0026quot;)  Distribución de los haitianos Este mapa destaca que la comuna mas popular para haitianos de 2019 fue Quilicura con 984 llegadas, o sea 13.79% del 7.135 haitianos que llegaron en 2019. Estación Central tambien contó con muchos haitianos con 758 haitianos (10.62%), asímismo Santiago Centro tuvo muchos llegados haitianos con 523 (7.33%). Es interesante anotar la falta de haitianos en el sector oriente con solo 25 haitianos de los que llegaron en 2019.\nhaitiano_count \u0026lt;- visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Haití\u0026#39;) %\u0026gt;% group_by(nombre_comuna) %\u0026gt;% count() %\u0026gt;% arrange(-n) visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Haití\u0026#39;) %\u0026gt;% count() ## # A tibble: 1 x 1 ## n ## \u0026lt;int\u0026gt; ## 1 7135 haitiano_count ## # A tibble: 32 x 2 ## # Groups: nombre_comuna [32] ## nombre_comuna n ## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; ## 1 Quilicura 984 ## 2 Estación Central 758 ## 3 Santiago 523 ## 4 Lo Espejo 426 ## 5 Recoleta 375 ## 6 Pedro Aguirre Cerda 367 ## 7 Cerro Navia 363 ## 8 Conchalí 280 ## 9 Quinta Normal 252 ## 10 El Bosque 248 ## # … with 22 more rows visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Haití\u0026#39; \u0026amp; nombre_comuna %in% c(\u0026#39;Providencia\u0026#39;, \u0026quot;Las Condes\u0026quot;, \u0026#39;Vitacura\u0026#39;, \u0026#39;Lo Barnechea\u0026#39;)) %\u0026gt;% count() ## # A tibble: 1 x 1 ## n ## \u0026lt;int\u0026gt; ## 1 25 STGgeo \u0026lt;- left_join(STGgeo, haitiano_count, by = \u0026quot;nombre_comuna\u0026quot;) STGgeo \u0026lt;- STGgeo %\u0026gt;% rename(numero_haitianos = n) ggplot() + geom_sf(data = STGgeo$geometry, aes(fill = STGgeo$numero_haitianos)) + scale_fill_viridis_c(option = \u0026quot;inferno\u0026quot;,trans = \u0026#39;sqrt\u0026#39;) + geom_text(data = STGgeo, aes(X, Y, label = labels), size = 3, color = \u0026quot;white\u0026quot;) + annotation_north_arrow(aes(which_north = \u0026quot;true\u0026quot;, location = \u0026quot;br\u0026quot;), pad_y = unit(0.8, \u0026quot;cm\u0026quot;)) + annotation_scale(aes(location = \u0026quot;br\u0026quot;, style = \u0026quot;bar\u0026quot;)) + theme(panel.grid.major = element_line(color = gray(0.5), linetype = \u0026quot;dashed\u0026quot;)) + theme (panel.background = element_rect(fill = \u0026quot;light grey\u0026quot;)) + ggtitle(\u0026quot;4.3 Ubicacion de Inmigrantes haitianos que llegaron en 2019\u0026quot;) + xlab(\u0026quot;Longitude\u0026quot;) + ylab(\u0026quot;Latitude\u0026quot;) + labs(fill = \u0026quot;Numero\u0026quot;)  Distribución de los estadounidenses De los 564 estado unidenses que llegaron en 2019, 352 (62.41%) vivieron en el sector orriente. Como para los venezolanos y haitianos la comuna de Santiago Centro otro vez contó con un gran por ceinto de las llegadas con 80 personas (14.18%). Tambien es interesante ver que hay varios comunas donde no había llegadas de los estados unidos. En comparación a lo que hemos visto hasta ahora con los venezolanos y los haitanos esta es una tendencia nueva, con estos dos otros nacionalidades teniendo una presencia en cada comuna de la ciudad.\neeuu_count \u0026lt;- visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Estados Unidos\u0026#39;) %\u0026gt;% group_by(nombre_comuna) %\u0026gt;% count() %\u0026gt;% arrange(-n) eeuu_count ## # A tibble: 23 x 2 ## # Groups: nombre_comuna [23] ## nombre_comuna n ## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; ## 1 Providencia 208 ## 2 Las Condes 110 ## 3 Santiago 80 ## 4 Maipú 57 ## 5 Ñuñoa 30 ## 6 Vitacura 21 ## 7 Lo Barnechea 13 ## 8 Estación Central 11 ## 9 Macul 5 ## 10 Independencia 4 ## # … with 13 more rows visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Estados Unidos\u0026#39;) %\u0026gt;% count()  ## # A tibble: 1 x 1 ## n ## \u0026lt;int\u0026gt; ## 1 564 visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Estados Unidos\u0026#39; \u0026amp; nombre_comuna %in% c(\u0026#39;Providencia\u0026#39;, \u0026quot;Las Condes\u0026quot;, \u0026#39;Vitacura\u0026#39;, \u0026#39;Lo Barnechea\u0026#39;)) %\u0026gt;% count() ## # A tibble: 1 x 1 ## n ## \u0026lt;int\u0026gt; ## 1 352 STGgeo \u0026lt;- left_join(STGgeo, eeuu_count, by = \u0026quot;nombre_comuna\u0026quot;) STGgeo \u0026lt;- STGgeo %\u0026gt;% rename(numero_eeuu = n) ggplot() + geom_sf(data = STGgeo$geometry, aes(fill = STGgeo$numero_eeuu)) + scale_fill_viridis_c(option = \u0026quot;inferno\u0026quot;,trans = \u0026#39;sqrt\u0026#39;) + geom_text(data = STGgeo, aes(X, Y, label = labels), size = 3, color = \u0026quot;white\u0026quot;) + annotation_north_arrow(aes(which_north = \u0026quot;true\u0026quot;, location = \u0026quot;br\u0026quot;), pad_y = unit(0.8, \u0026quot;cm\u0026quot;)) + annotation_scale(aes(location = \u0026quot;br\u0026quot;, style = \u0026quot;bar\u0026quot;)) + theme(panel.grid.major = element_line(color = gray(0.5), linetype = \u0026quot;dashed\u0026quot;)) + theme (panel.background = element_rect(fill = \u0026quot;light grey\u0026quot;)) + ggtitle(\u0026quot;4.4 Ubicacion de Inmigrantes de Los Estados Unidos que llegaron en 2019\u0026quot;) + xlab(\u0026quot;Longitude\u0026quot;) + ylab(\u0026quot;Latitude\u0026quot;) + labs(fill = \u0026quot;Numero\u0026quot;)  Distribución de los peruanos Sanitago Centro, Recoleta, y Independencia fueron las tres comunas con llegadas de inmigrantes peruanos en 2019 con 2.785 (24.27%), 1.272 (11.09%), y 1.092 (9.51%) respectivamente. Se contaron 855 (7.45%) peruanos en el sector orriente.\nperuano_count \u0026lt;- visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Perú\u0026#39;) %\u0026gt;% group_by(nombre_comuna) %\u0026gt;% count() %\u0026gt;% arrange(-n) visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Perú\u0026#39;) %\u0026gt;% count() ## # A tibble: 1 x 1 ## n ## \u0026lt;int\u0026gt; ## 1 11474 visas2019STG %\u0026gt;% filter(PAÍS == \u0026#39;Perú\u0026#39; \u0026amp; nombre_comuna %in% c(\u0026#39;Providencia\u0026#39;, \u0026quot;Las Condes\u0026quot;, \u0026#39;Vitacura\u0026#39;, \u0026#39;Lo Barnechea\u0026#39;)) %\u0026gt;% count() ## # A tibble: 1 x 1 ## n ## \u0026lt;int\u0026gt; ## 1 855 peruano_count ## # A tibble: 32 x 2 ## # Groups: nombre_comuna [32] ## nombre_comuna n ## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt; ## 1 Santiago 2785 ## 2 Recoleta 1272 ## 3 Independencia 1092 ## 4 Estación Central 634 ## 5 Quinta Normal 585 ## 6 Conchalí 475 ## 7 Peñalolén 415 ## 8 Las Condes 373 ## 9 La Florida 335 ## 10 Lo Prado 320 ## # … with 22 more rows STGgeo \u0026lt;- left_join(STGgeo, peruano_count, by = \u0026quot;nombre_comuna\u0026quot;) STGgeo \u0026lt;- STGgeo %\u0026gt;% rename(numero_peruanos = n) ggplot() + geom_sf(data = STGgeo$geometry, aes(fill = STGgeo$numero_peruanos)) + scale_fill_viridis_c(option = \u0026quot;inferno\u0026quot;,trans = \u0026#39;sqrt\u0026#39;) + geom_text(data = STGgeo, aes(X, Y, label = labels), size = 3, color = \u0026quot;white\u0026quot;) + annotation_north_arrow(aes(which_north = \u0026quot;true\u0026quot;, location = \u0026quot;br\u0026quot;), pad_y = unit(0.8, \u0026quot;cm\u0026quot;)) + annotation_scale(aes(location = \u0026quot;br\u0026quot;, style = \u0026quot;bar\u0026quot;)) + theme(panel.grid.major = element_line(color = gray(0.5), linetype = \u0026quot;dashed\u0026quot;)) + theme (panel.background = element_rect(fill = \u0026quot;light grey\u0026quot;)) + ggtitle(\u0026quot;4.5 Ubicacion de Inmigrantes Peruanos que llegaron en 2019\u0026quot;) + xlab(\u0026quot;Longitude\u0026quot;) + ylab(\u0026quot;Latitude\u0026quot;) + labs(fill = \u0026quot;Numero\u0026quot;) Ahora ya que se han explorado los datos y se han visto la distribucion de cuatro nacionalidades a lo largo de la ciudad, voy a crear un modelo de classificación.\n  5) Modelo de Clasificación La idea de esta sección es crear un modelo de clasificación para predecir en cual comuna un inmigrante vivían cuando llegaron a Santiago de Chile en 2019. Primero he elegido los vaiables de visas2019STG que quiero usar.\nvisas2019STGfilter \u0026lt;- visas2019STG %\u0026gt;% select(SEXO, PAÍS, ACTIVIDAD, PROFESIÓN, ESTUDIOS, nombre_comuna, AÑO, MES, Age) Sector Orriente Despues de eso he manipulado el variable de nombre_comuna para crear sector_orriente, que va a ser el variable dependiente, es decir, el variable que el modelo va a classificar. A puesto que solo tiene dos niveles (1 o 0) es un variable binomial. 1 significa que un inmigrante vivió en el sector orriente, y 0 significa que vivió en un parte differente de la ciudad.\nvisas2019STGfilter$SECTOR_ORRIENTE \u0026lt;- if_else(visas2019STGfilter$nombre_comuna == \u0026#39;Providencia\u0026#39;, 1, if_else(visas2019STGfilter$nombre_comuna == \u0026#39;Las Condes\u0026#39;, 1, if_else(visas2019STGfilter$nombre_comuna == \u0026#39;Vitacura\u0026#39;, 1, if_else(visas2019STGfilter$nombre_comuna ==\u0026#39;Lo Barnechea\u0026#39;, 1, 0))))  Que es el sector orriente? El sector orriente contiene las comunas de Providencia, Las Condes, Viacura, y Lo Barnechea y se queda al norte orriente de la ciudad. Estas comunas se consideran ser las mas ricas con las mejores calidades de vida. Se destacan las cuatros comunas en el mapa 5.1.\nSectorOriente \u0026lt;- STGgeo %\u0026gt;% filter(nombre_comuna == \u0026#39;Providencia\u0026#39; | nombre_comuna == \u0026#39;Las Condes\u0026#39; | nombre_comuna == \u0026#39;Vitacura\u0026#39; | nombre_comuna == \u0026#39;Lo Barnechea\u0026#39;) ggplot() + geom_sf(data = STGgeo$geometry, fill = \u0026quot;white\u0026quot;) + geom_sf(data = SectorOriente$geometry, fill = \u0026quot;purple\u0026quot;) + geom_text(data = STGgeo, aes(X, Y, label = labels), size = 3, color = \u0026quot;white\u0026quot;) + annotation_north_arrow(aes(which_north = \u0026quot;true\u0026quot;, location = \u0026quot;br\u0026quot;), pad_y = unit(0.8, \u0026quot;cm\u0026quot;)) + annotation_scale(aes(location = \u0026quot;br\u0026quot;, style = \u0026quot;bar\u0026quot;)) + theme(panel.grid.major = element_line(color = gray(0.5), linetype = \u0026quot;dashed\u0026quot;)) + theme (panel.background = element_rect(fill = \u0026quot;light grey\u0026quot;)) + ggtitle(\u0026quot;5.1 Ubicacion del Sector Orriente\u0026quot;) + xlab(\u0026quot;Longitude\u0026quot;) + ylab(\u0026quot;Latitude\u0026quot;)  One Hot Encoding En el base de datos hay varios variables categóricos. One Hot Encoding es un proceso que se usa para convertir estos variables categóricos en una forma que es mas facil para computar para modelos de aprendizaje automatico.\nCuando se aplica one hot encoding a variables categóricas, se crean nuevas columnas, una para cada nivel de las variable. Por ejemplo, si la variable es sexo, se crearían dos columnas más, una que se llamaría Hombre y la segunda que se llamaría Mujer. La columna para hombres tiene 1 anotado para todas las observaciones que son hombres y 0 para todas las que no son hombres. Asimismo, la columna para las mujeres tiene 1 anotado para todas las variables que son mujeres y 0 para todas las que no son mujeres.\nBásicamente, la variable de sexo se ha dividido entre dos, una que dice sí o no en relación con la pregunta de si uno es hombre y la otra que responde a la misma pregunta, pero para las mujeres. De esta manera, utilizando valores numéricos en lugar de categorías, el modelo puede mejorar sus predicciones y ejecutarse mas rapidamente.\nHe llevado a cabo one hot encoding para los variables de SEXO, ACTIVIDAD, y ESTUDIOS.\nSEXO model_matrix(visas2019STGfilter, SECTOR_ORRIENTE~SEXO-1) visas2019STGfilter \u0026lt;- cbind(visas2019STGfilter, model_matrix(visas2019STGfilter, SECTOR_ORRIENTE~SEXO-1))  ACTIVIDAD model_matrix(visas2019STGfilter, SECTOR_ORRIENTE~ACTIVIDAD-1) visas2019STGfilter \u0026lt;- cbind(visas2019STGfilter, model_matrix(visas2019STGfilter, SECTOR_ORRIENTE~ACTIVIDAD-1))  ESTUDIOS model_matrix(visas2019STGfilter, SECTOR_ORRIENTE~ESTUDIOS-1) visas2019STGfilter \u0026lt;- cbind(visas2019STGfilter, model_matrix(visas2019STGfilter, SECTOR_ORRIENTE~ESTUDIOS-1))  PAÍS a Continentes Hasta ahora el base de datos tiene el país de cada inmigrante recopilado. En total hay 75 países, esta cantidad de niveles le hace dificil al modelo funcionar bien. Por lo tanto voy a agrupar los países por su continente antes de hacer el one hot encoding.\nvisas2019STGfilter$continente \u0026lt;- fct_collapse(visas2019STGfilter$PAÍS, Europe = c(\u0026#39;Alemania\u0026#39;, \u0026#39;Austria\u0026#39;, \u0026#39;Bélgica\u0026#39;, \u0026#39;Bulgaria\u0026#39;, \u0026#39;Croacia\u0026#39;, \u0026#39;Dinamarca\u0026#39;, \u0026#39;Eslovaquia\u0026#39;, \u0026#39;España\u0026#39;, \u0026#39;Finlandia\u0026#39;, \u0026#39;Francia\u0026#39;, \u0026#39;Grecia\u0026#39;, \u0026#39;Holanda\u0026#39;, \u0026#39;Hungría\u0026#39;, \u0026#39;Inglaterra\u0026#39;, \u0026#39;Irlanda\u0026#39;, \u0026#39;Italia\u0026#39;, \u0026#39;Lituania\u0026#39;, \u0026#39;Noruega\u0026#39;, \u0026#39;Polonia\u0026#39;, \u0026#39;Portugal\u0026#39;, \u0026#39;República Checa\u0026#39;, \u0026#39;República De Bielorrusia\u0026#39;, \u0026#39;República De Serbia\u0026#39;, \u0026#39;Rumanía\u0026#39;, \u0026#39;Rusia\u0026#39;, \u0026#39;Suecia\u0026#39;, \u0026#39;Suiza\u0026#39;, \u0026#39;Ucrania\u0026#39;), Africa = c(\u0026#39;Angola\u0026#39;, \u0026#39;Camerún\u0026#39;, \u0026#39;Egipto\u0026#39;, \u0026#39;Marruecos\u0026#39;, \u0026#39;República de Congo\u0026#39;, \u0026#39;Sudráfica\u0026#39;), Asia = c(\u0026#39;Bangladesh\u0026#39;, \u0026#39;Corea del Sur\u0026#39;, \u0026#39;China\u0026#39;, \u0026#39;Filipinas\u0026#39;, \u0026#39;India\u0026#39;, \u0026#39;Indonesia\u0026#39;, \u0026#39;Irán\u0026#39;, \u0026#39;Israel\u0026#39;, \u0026#39;Japón\u0026#39;, \u0026#39;Jordania\u0026#39;, \u0026#39;Líbano\u0026#39;, \u0026#39;Malasia\u0026#39;, \u0026#39;Nepal\u0026#39;, \u0026#39;Pakistán\u0026#39;, \u0026#39;Palestina\u0026#39;, \u0026#39;Siria\u0026#39;, \u0026#39;Tailandia\u0026#39;, \u0026#39;Taiwan\u0026#39;, \u0026#39;Turquía\u0026#39;), SouthAmerica = c(\u0026#39;Argentina\u0026#39;, \u0026#39;Bolivia\u0026#39;, \u0026#39;Brasil\u0026#39;, \u0026#39;Colombia\u0026#39;, \u0026#39;Ecuador\u0026#39;, \u0026#39;Paraguay\u0026#39;, \u0026#39;Perú\u0026#39;, \u0026#39;Uruguay\u0026#39;, \u0026#39;Venezuela\u0026#39;), CentralAmerica = c(\u0026#39;Costa Rica\u0026#39;, \u0026#39;Cuba\u0026#39;, \u0026#39;El Salvador\u0026#39;, \u0026#39;Guatemala\u0026#39;, \u0026#39;Haití\u0026#39;, \u0026#39;Honduras\u0026#39;, \u0026#39;México\u0026#39;, \u0026#39;Nicaragua\u0026#39;, \u0026#39;Panamá\u0026#39;,\u0026#39;República Dominicana\u0026#39;), NorthAmerica = c(\u0026#39;Canadá\u0026#39;, \u0026#39;Estados Unidos\u0026#39;), Other = c(\u0026#39;Otro país\u0026#39;), Oceania = c(\u0026#39;Australia\u0026#39;, \u0026#39;Nueva Zelanda\u0026#39;)) visas2019STGfilter \u0026lt;- cbind(visas2019STGfilter, model_matrix(visas2019STGfilter, SECTOR_ORRIENTE~continente-1)) head(visas2019STGfilter)   Creando el Modelo En aprendizaje automatico es importante dividir los datos en dos grupos. Uno con la mayoria de los observaciones para entrenar el modelo, y el otro con los observaciones que quedan para ensayar el modelo. Por lo tanto he dividido el base en dos grupos, un grupo que tiene 75% de las observaciones para entrenar el modelo, y el segundo grupo que tiene 25% para ensayar el modelo.\nsplit \u0026lt;- sample.split(visas2019STGfilter$SECTOR_ORRIENTE, SplitRatio = 0.75) training_set \u0026lt;- subset(visas2019STGfilter, split == TRUE) test_set \u0026lt;- subset(visas2019STGfilter, split == FALSE) training_set_cut \u0026lt;- training_set[,c(-1, -2, -3, -4, -5, -6, -7, -8, -9, -34)] test_set_cut \u0026lt;- test_set[,c(-1, -2, -3, -4, -5, -6, -7, -8, -9, -34)]  Entrenar Modelo Para este modelo he usado un ‘modelo lineal generalizado’ (glm). En futuros informes, llevaré a cabo esta investigación con otros tipos de modelos con comparación para ver qué tipo de modelo ofrece las mejores predicciones.\nset.seed(1234) classifier = glm(formula = SECTOR_ORRIENTE ~., family = binomial, data = training_set_cut)  Predicciones He usado el modelo (classifier) para generar predicciones para el grupo de prueba. Las predicciones son entre 0 y 1. Si es \u0026gt;= 0.5 se classificaría como 1 y que vive en el sector orriente y si es \u0026lt; 0.5 se classificarían como 0 y que no viven en el sector orriente. Para mostrar la precisión del modelo he usado una matriz de confusión.\nprob_pred \u0026lt;- predict(classifier, type = \u0026#39;response\u0026#39;, newdata = test_set_cut[,c(-1)]) y_pred \u0026lt;- ifelse(prob_pred \u0026gt;= 0.5, 1, 0) cm \u0026lt;- confusionMatrix(factor(test_set_cut$SECTOR_ORRIENTE), factor(y_pred), positive = \u0026quot;1\u0026quot;) cm ## Confusion Matrix and Statistics ## ## Reference ## Prediction 0 1 ## 0 22599 186 ## 1 1614 265 ## ## Accuracy : 0.927 ## 95% CI : (0.9237, 0.9302) ## No Information Rate : 0.9817 ## P-Value [Acc \u0026gt; NIR] : 1 ## ## Kappa : 0.204 ## ## Mcnemar\u0026#39;s Test P-Value : \u0026lt;2e-16 ## ## Sensitivity : 0.58758 ## Specificity : 0.93334 ## Pos Pred Value : 0.14103 ## Neg Pred Value : 0.99184 ## Prevalence : 0.01829 ## Detection Rate : 0.01074 ## Detection Prevalence : 0.07618 ## Balanced Accuracy : 0.76046 ## ## \u0026#39;Positive\u0026#39; Class : 1 ##   Explicacion del Matrix de Confusión El matrix es una tabla que muestra los valores actuales y los valores predichos. La imagen expone el diseño del matrix con los valores predichos en las filas, y los valores reales en los clomunas. Por lo tanto se sabe que la celuda en fila 1 columna 1 respresenta valores de 0 que se predicen como 0. Asimismo se sabe que la celuda en fila 2 columna 2 representa valores de 1 que se predicen como 1.\nHay cuatro valores importantes que se puede sacar del matrix para dar información sobre su precisión. * Accuaracy * Kappa * Precision * Recall\nVamos a analizarlos.\nAccuracy El matrix tiene un accuracy de 0.929. Significa que 92.9% de los observaciones se classifican por el modelo correctamente.\n Precision Una precision de 64.21% significa que en todos los inmigrantes que se predicen vivir en el sector orriente, 64.21% realmente viven allá.\nVerdadoPositivo = 287 FalsoPositivo = 160 FalsoNegativo = 1592 precision \u0026lt;- VerdadoPositivo/(VerdadoPositivo+FalsoPositivo) precision ## [1] 0.6420582  Recall El valor de 15.27% para recall significa que 15.27% de los inmigrantes se han clasificado como alguien que vive en el sector oriente.\nrecall \u0026lt;- VerdadoPositivo/(VerdadoPositivo+FalsoNegativo) recall ## [1] 0.1527408   Kappa A puesto que los datos son desequilibrados con muchos mas obervaciones de inmigrantes que no viven en el setor orriente se puede usar el valor de kappa. Mide de qué tan bien se desempeñó el clasificador en comparación con qué tan bien se hubiera desempeñado simplemente por casualidad. Es un valor importante con datos desequilibrados. Puede tomar valores entre 0 y 1. Mas cerca a 1 significa que la clasificación en el model es mas precisa. Nuestro matrix tiene un kappa valor de 0.22. Significa que el modelo obtiene una precision de classificacion 22% mejor que la classificacion de una classificacion aleatoria (precision expextada de 90.84).Con una kappa de 0.22 el modelo tiene una precision de 92.8552 [90.84 + (((100 - 90.84) / 100) * 22)].\nSe puede leer mas sobre como caluclarl todo eso aca [https://stats.stackexchange.com/questions/82162/cohens-kappa-in-plain-english?noredirect=1\u0026amp;lq=1]\n  6) Conclusion En conclusión, en esta publicación he analizado la distribución en todo Santiago de inmigrantes de diferentes nacionalidades que llegaron en 2019. También he creado un modelo de clasificación lineal generalizado para clasificar si un inmigrante vivía en el sector oriental de la ciudad. Con una precisión del 92.9% y una precisión kappa del 92.8552%, vemos que el modelo ha tenido cierto éxito. Pero con un valor de precisión del 64,21% y un valor de retiro del 15,27%, nos dice que el modelo no es lo suficientemente bueno para clasificar a las personas que vivían en el sector oriental. Por lo tanto, en futuras publicaciones exploraré cómo se puede mejorar la precisión del modelo.\n  ","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"es","lastmod":-62135596800,"objectID":"916b3d564de6d971736147eb584956a1","permalink":"/es/post/migration/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/es/post/migration/","section":"post","summary":"Donde viven los inmigrantes en Santiago de Chile? Hace un par de meses lleve acabo una investigación de donde viven los inmigrantes en Santiago de Chile, el informe se puede leer acá https://portugalconcopiapo.","tags":null,"title":"Un análisis de datos de inmigración en Santiago de Chile utilizando técnicas de aprendizaje automático","type":"post"}]